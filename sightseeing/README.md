# D - 観光スポット

## 問題文

ランダムの部員達は、合宿の行き先の観光地を決めようとしています。

候補となっている各地域について、Y博士が事前に部員達の満足度が最大となる観光スポットの訪れる順番を計算してくれています。
しかし、Y博士の計算には移動距離のことが考慮されていませんでした。
部員は皆、外で移動するのが面倒だと思っているため、できるだけ少ない移動で観光スポットを満喫できる地域にしたいと考えています。

あなたは、部員達の合宿の行き先決定のために、
Y博士の提案する訪問順序を守って全ての観光スポットを訪れる最短ルートを計算するプログラムの作成を頼まれました。

## 入力

入力は、複数のデータセットから構成され、1つの入力に含まれるデータセットの数は25以下である。
各データセットの形式は次の通りである。

N M S
l<sub>1</sub> r<sub>1</sub> d<sub>1</sub>
...
l<sub>N</sub> r<sub>N</sub> d<sub>N</sub>
p<sub>1</sub> a<sub>1</sub>
...
p<sub>M</sub> a<sub>M</sub>
s<sub>1</sub> ... s<sub>S</sub>

入力は全て整数値で与えられる。

まず、地図の情報とY博士に指定された順番の情報が与えられる。
N(1≦N≦500)は道路の数、M(1≦M≦2,500)は観光スポットの数、S(1≦S≦12,500)は訪れる観光スポットの数を表す。

次のN行で、道路の情報が与えられる。
i行目には、道路i番の2つの端点l<sub>i</sub>とr<sub>i</sub>、道路の長さd<sub>i</sub>が入力される。

続くM行で、観光スポットの情報が与えられる。
i行目には、観光スポット番号iが存在する道路番号p<sub>M</sub>と、
道路上の端点l<sub>p<sub>M</sub></sub>からの距離a<sub>M</sub>が入力される。
端点l<sub>p<sub>M</sub></sub>またはr<sub>p<sub>M</sub></sub>上に観光スポットが存在することもあり、
また同じ場所に複数の観光スポットが存在することもある。

次に、Y博士に指定された観光スポットを巡る順番が与えられる。
s<sub>i</sub>は、i番目に訪れる観光スポット番号を表す。
複数回訪れることで魅力を感じられる場所もあるため、Y博士は同じ場所に複数回訪れるように指示する場合がある。

入力の終わりは、N=M=S=0の行によって表される。このデータは処理を行ってはならない。

## 出力

各データセットにつき、Y博士の指示通りに全ての観光スポットを訪れることができる最短距離を1行で出力せよ。

## 入力例

```
2 5 5
1 2 5
2 5 12
1 2
1 4
2 2
2 5
2 10
1 3 5 2 4
5 5 3
1 2 5
2 3 5
3 4 5
4 1 5
1 3 5
1 2
2 2
3 1
4 2
5 2
1 2 5
0 0 0
```

## 出力例

```
30
11
```
